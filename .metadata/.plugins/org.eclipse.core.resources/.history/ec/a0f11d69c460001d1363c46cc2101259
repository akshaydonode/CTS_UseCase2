package com.cts.dataloader.services;

import java.io.IOException;
import java.util.Iterator;

import org.apache.poi.ss.usermodel.Cell;
import org.apache.poi.ss.usermodel.Row;
import org.apache.poi.xssf.usermodel.XSSFSheet;
import org.apache.poi.xssf.usermodel.XSSFWorkbook;
import org.springframework.stereotype.Service;
import org.springframework.web.multipart.MultipartFile;
//import org.apache.poi.xssf.usermodel.XSSFWorkbook;  

@Service
public class PatientServiceImpl implements PatientService {

	@Override
	public String patientData(MultipartFile excelFile) {

		try {
			// creating Workbook instance that refers to .xlsx file
			XSSFWorkbook xssfWorkbook = new XSSFWorkbook(excelFile.getInputStream());

			XSSFSheet sheet = xssfWorkbook.getSheetAt(0); // creating a Sheet object to retrieve object
			Iterator<Row> itr = sheet.iterator(); // iterating over excel file

			while (itr.hasNext()) {
				
				Row row = itr.next();
				Iterator<Cell> cellIterator = row.cellIterator(); // iterating over each column
				
				while (cellIterator.hasNext()) {
					
					Cell cell = cellIterator.next();
					
					System.out.println(cell.getStringCellValue());
					
					
//					switch (cell.getCellType()) {
//					case CellType : // field that represents string cell type
//						System.out.print(cell.getStringCellValue() + "\t\t\t");
//						break;
//					case Cell.CELL_TYPE_NUMERIC: // field that represents number cell type
//						System.out.print(cell.getNumericCellValue() + "\t\t\t");
//						break;
//					default:
//					}
				}
				System.out.println("");
			}

		} catch (IOException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}

		return null;

	}

}
